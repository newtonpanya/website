<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>YCT Online Quiz Version 1.0</title>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC&display=swap" rel="stylesheet">
<style>
body {
  font-family: 'Noto Sans SC', Arial, sans-serif;
  padding: 20px;
  background: linear-gradient(rgba(255,255,255,0.9), rgba(255,255,255,0.9)),
  url('https://upload.wikimedia.org/wikipedia/commons/0/0d/Flag_of_China.svg');
  background-size: cover;
  background-position: center;
  background-attachment: fixed;
  min-height: 100vh;
}
.container {
  max-width: 900px;
  margin: auto;
  background: rgba(255,255,255,0.95);
  padding: 25px;
  border-radius: 15px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.25);
}
h1 {
  text-align: center;
  color: #D32F2F;
  text-shadow: 1px 1px 2px #fff;
}
h2 {
  text-align: center;
  color: #B71C1C;
}
button {
  background-color: #FFD54F;
  color: #B71C1C;
  font-weight: bold;
  border: none;
  border-radius: 10px;
  padding: 10px 20px;
  margin: 10px;
  cursor: pointer;
  transition: 0.3s;
}
button:hover {
  background-color: #FFEE58;
}
.correct {
  background-color: #4CAF50 !important;
  color: white !important;
}
.wrong {
  background-color: #E53935 !important;
  color: white !important;
}
.hidden {
  display: none;
}
.timer {
  text-align: center;
  font-weight: bold;
  font-size: 1.3rem;
  color: #B71C1C;
  margin-bottom: 10px;
}
.question {
  font-size: 1.2rem;
  margin-bottom: 20px;
  background: rgba(255,255,255,0.9);
  padding: 20px;
  border-radius: 12px;
  box-shadow: 0 3px 8px rgba(0,0,0,0.15);
}
.options button {
  display: block;
  width: 100%;
  margin: 6px 0;
  padding: 10px;
}
input[type="text"] {
  width: 100%;
  padding: 8px;
  border-radius: 8px;
  border: 1px solid #ccc;
}
table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 15px;
}
th, td {
  border: 1px solid #ddd;
  padding: 8px;
  text-align: center;
}
th {
  background: #FBC02D;
}
</style>
</head>
<body>
<div class="container">
  <h1>🧧 YCT Online Quiz 🧧</h1>

  <!-- หน้าเริ่มต้น -->
  <div id="startScreen">
    <p>แบบทดสอบภาษาจีน YCT ออนไลน์<br>
    ระดับต้นถึงระดับ 2<br>
    ⏰ จำกัดเวลา 60 วินาทีต่อข้อ<br>
    📚 เลือกชุดข้อสอบ YCT1 (15 ข้อ) หรือ YCT2 (20 ข้อ)</p>
    <button onclick="startQuiz('YCT1')">เริ่มทำ YCT 1</button>
    <button onclick="startQuiz('YCT2')">เริ่มทำ YCT 2</button>
    <button onclick="showLeaderboard()">🏆 ดูคะแนนทั้งหมด</button>
    <button onclick="enterTeacherMode()">👩‍🏫 โหมดครู</button>
  </div>

  <!-- หน้าทำข้อสอบ -->
  <div id="quizScreen" class="hidden">
    <div class="timer" id="timer">เวลา: 60</div>
    <div id="questionBox"></div>
  </div>

  <!-- หน้าผลลัพธ์ -->
  <div id="resultScreen" class="hidden">
    <h2>ผลคะแนน</h2>
    <p id="scoreDisplay"></p>
    <div id="answerList"></div>
    <label>กรอกชื่อก่อนบันทึก: </label>
    <input type="text" id="studentName" placeholder="ชื่อของคุณ">
    <button onclick="saveScore()">💾 บันทึกคะแนน</button>
    <button onclick="backHome()">🏠 กลับหน้าหลัก</button>
  </div>

  <!-- Leaderboard -->
  <div id="leaderboardScreen" class="hidden">
    <h2>🏆 Leaderboard</h2>
    <table id="leaderboardTable">
      <thead><tr><th>ชื่อ</th><th>ชุด</th><th>คะแนน</th><th>เวลา</th></tr></thead>
      <tbody></tbody>
    </table>
    <button onclick="backHome()">🏠 กลับหน้าหลัก</button>
  </div>

  <!-- โหมดครู -->
  <div id="teacherScreen" class="hidden">
    <h2>👩‍🏫 โหมดครู</h2>
    <table id="teacherTable">
      <thead><tr><th>ชื่อ</th><th>ชุด</th><th>คะแนน</th><th>เวลา</th><th>การจัดการ</th></tr></thead>
      <tbody></tbody>
    </table>
    <button onclick="addRecord()">➕ เพิ่ม</button>
    <button onclick="clearAll()">🧹 เคลียร์ทั้งหมด</button>
    <button onclick="backHome()">🏠 กลับหน้าหลัก</button>
  </div>
</div>

<script>
// ==== ชุดข้อสอบ ====
const questions = {
  YCT1: [
    { q: "他是老师。tā shì lǎoshī. หมายถึงอะไร?", opts: ["เขาเป็นครู", "เขาเป็นนักเรียน", "เขาเป็นหมอ"], ans: 0 },
    { q: "谢谢！xièxie! แปลว่าอะไร?", opts: ["สวัสดี", "ขอบคุณ", "ลาก่อน"], ans: 1 },
    { q: "再见！zàijiàn!", opts: ["ลาก่อน", "สวัสดี", "ขอบคุณ"], ans: 0 },
    { q: "妈妈 māma หมายถึง?", opts: ["พ่อ", "แม่", "พี่สาว"], ans: 1 },
    { q: "我爱你 wǒ ài nǐ", opts: ["ฉันรักเธอ", "ฉันเกลียดเธอ", "สวัสดี"], ans: 0 },
    { q: "他是谁？tā shì shuí?", opts: ["เขาอยู่ไหน", "เขาเป็นใคร", "เขาทำอะไร"], ans: 1 },
    { q: "我喜欢苹果。", opts: ["ฉันชอบแอปเปิ้ล", "ฉันกินกล้วย", "ฉันไม่ชอบส้ม"], ans: 0 },
    { q: "谢谢老师。", opts: ["ขอบคุณครู", "ลาก่อนครู", "ครูอยู่ไหน"], ans: 0 },
    { q: "我叫明明。", opts: ["ฉันชื่อหมิงหมิง", "ฉันชื่อหงหง", "ฉันชื่ออาเต๋อ"], ans: 0 },
    { q: "你好吗？", opts: ["เธออยู่ที่ไหน", "สบายดีไหม", "เธอทำอะไร"], ans: 1 },
    { q: "我很好。", opts: ["ฉันดีมาก", "ฉันเหนื่อย", "ฉันเศร้า"], ans: 0 },
    { q: "爸爸在家。", opts: ["พ่ออยู่บ้าน", "แม่อยู่บ้าน", "พ่ออยู่โรงเรียน"], ans: 0 },
    { q: "我有一个哥哥。", opts: ["ฉันมีพี่ชายคนหนึ่ง", "ฉันไม่มีพี่ชาย", "ฉันมีน้องชาย"], ans: 0 },
    { q: "我喜欢学习。", opts: ["ฉันชอบเรียน", "ฉันเกลียดเรียน", "ฉันอยากนอน"], ans: 0 },
    { q: "谢谢你。", opts: ["สวัสดี", "ขอบคุณ", "ลาก่อน"], ans: 1 }
  ],
  YCT2: [
    { q: "你叫什么名字？", opts: ["คุณชื่ออะไร", "คุณอยู่ที่ไหน", "คุณอายุเท่าไร"], ans: 0 },
    { q: "我喜欢苹果。", opts: ["ฉันไม่ชอบแอปเปิ้ล", "ฉันชอบแอปเปิ้ล", "ฉันกินแอปเปิ้ล"], ans: 1 },
    { q: "他几岁？", opts: ["เขาอายุเท่าไร", "เขาอยู่ไหน", "เขาชื่ออะไร"], ans: 0 },
    { q: "今天星期几？", opts: ["วันนี้วันอะไร", "พรุ่งนี้วันอะไร", "เมื่อวานวันอะไร"], ans: 0 },
    { q: "我在学校。", opts: ["ฉันอยู่โรงเรียน", "ฉันอยู่บ้าน", "ฉันไปตลาด"], ans: 0 },
    { q: "现在几点？", opts: ["ตอนนี้กี่โมง", "วันนี้วันอะไร", "พรุ่งนี้กี่โมง"], ans: 0 },
    { q: "我有两个姐姐。", opts: ["ฉันมีพี่สาวสองคน", "ฉันมีพี่ชายสองคน", "ฉันไม่มีพี่"], ans: 0 },
    { q: "你会游泳吗？", opts: ["คุณว่ายน้ำได้ไหม", "คุณเต้นได้ไหม", "คุณวิ่งได้ไหม"], ans: 0 },
    { q: "他在做什么？", opts: ["เขากำลังทำอะไร", "เขาอยู่ไหน", "เขาเป็นใคร"], ans: 0 },
    { q: "明天见。", opts: ["พบกันพรุ่งนี้", "ลาก่อน", "สวัสดีตอนเช้า"], ans: 0 },
    { q: "她很漂亮。", opts: ["เธอสวยมาก", "เธอสูงมาก", "เธออ้วนมาก"], ans: 0 },
    { q: "你喜欢什么颜色？", opts: ["คุณชอบสีอะไร", "คุณอยู่ที่ไหน", "คุณอายุเท่าไร"], ans: 0 },
    { q: "他在吃饭。", opts: ["เขากำลังกินข้าว", "เขากำลังนอน", "เขากำลังวิ่ง"], ans: 0 },
    { q: "你在哪儿？", opts: ["คุณอยู่ที่ไหน", "คุณชื่ออะไร", "คุณกำลังทำอะไร"], ans: 0 },
    { q: "我有一只狗。", opts: ["ฉันมีสุนัขหนึ่งตัว", "ฉันมีแมวหนึ่งตัว", "ฉันไม่มีสัตว์"], ans: 0 },
    { q: "你家有几口人？", opts: ["บ้านคุณมีกี่คน", "บ้านคุณอยู่ที่ไหน", "บ้านคุณใหญ่ไหม"], ans: 0 },
    { q: "他是我的朋友。", opts: ["เขาเป็นเพื่อนของฉัน", "เขาเป็นพี่ชายฉัน", "เขาเป็นครูของฉัน"], ans: 0 },
    { q: "请坐。", opts: ["เชิญนั่ง", "เชิญกิน", "เชิญเข้า"], ans: 0 },
    { q: "不要说话。", opts: ["อย่าพูด", "อย่ากิน", "อย่าเดิน"], ans: 0 },
    { q: "谢谢老师。", opts: ["ขอบคุณครู", "ลาก่อนครู", "สวัสดีครู"], ans: 0 }
  ]
};

// ==== ระบบทำข้อสอบ ====
let currentSet="", currentQ=0, score=0, answers=[], timer, timeLeft=60;

function startQuiz(set){
  currentSet=set; currentQ=0; score=0; answers=[];
  document.getElementById("startScreen").classList.add("hidden");
  document.getElementById("quizScreen").classList.remove("hidden");
  showQuestion();
}

function showQuestion(){
  const q = questions[currentSet][currentQ];
  if(!q) return finishQuiz();
  document.getElementById("questionBox").innerHTML = `
    <div class="question"><b>ข้อ ${currentQ+1}:</b> ${q.q}</div>
    <div class="options">
      ${q.opts.map((opt,i)=>`<button onclick="checkAnswer(${i})">${opt}</button>`).join("")}
    </div>`;
  resetTimer();
}

function resetTimer(){
  clearInterval(timer);
  timeLeft = 60;
  document.getElementById("timer").innerText = "เวลา: 60";
  timer = setInterval(()=>{
    timeLeft--;
    document.getElementById("timer").innerText = "เวลา: " + timeLeft;
    if(timeLeft <= 0){clearInterval(timer); nextQuestion();}
  },1000);
}

function checkAnswer(i){
  clearInterval(timer);
  const q = questions[currentSet][currentQ];
  const btns = document.querySelectorAll(".options button");
  btns.forEach((b,idx)=>{
    if(idx===q.ans) b.classList.add("correct");
    else if(idx===i) b.classList.add("wrong");
    b.disabled=true;
  });
  if(i===q.ans) score++;
  answers.push({q:q.q, correct:q.opts[q.ans], chosen:q.opts[i] || "ไม่ตอบ"});
  setTimeout(nextQuestion,1000);
}

function nextQuestion(){
  currentQ++;
  if(currentQ < questions[currentSet].length) showQuestion();
  else finishQuiz();
}

function finishQuiz(){
  document.getElementById("quizScreen").classList.add("hidden");
  document.getElementById("resultScreen").classList.remove("hidden");
  document.getElementById("scoreDisplay").innerText = `คุณได้ ${score}/${questions[currentSet].length} คะแนน`;
  document.getElementById("answerList").innerHTML = answers.map(a=>
    `<p>${a.q}<br>✅ ถูก: <b>${a.correct}</b><br>📝 คุณตอบ: ${a.chosen}</p>`).join("<hr>");
}

function saveScore(){
  const name = document.getElementById("studentName").value.trim();
  if(!name) return alert("กรุณากรอกชื่อ");
  const timeNow = new Date();
  const tStr = timeNow.toLocaleTimeString('th-TH') + " " + timeNow.toLocaleDateString('th-TH');
  const record = {name, set: currentSet, score, time: tStr};
  const data = JSON.parse(localStorage.getItem("yctScores")||"[]");
  data.push(record);
  localStorage.setItem("yctScores", JSON.stringify(data));
  alert("บันทึกสำเร็จ!");
  backHome();
}

function backHome(){
  document.getElementById("startScreen").classList.remove("hidden");
  document.getElementById("quizScreen").classList.add("hidden");
  document.getElementById("resultScreen").classList.add("hidden");
  document.getElementById("leaderboardScreen").classList.add("hidden");
  document.getElementById("teacherScreen").classList.add("hidden");
}

function showLeaderboard(){
  document.getElementById("startScreen").classList.add("hidden");
  document.getElementById("leaderboardScreen").classList.remove("hidden");
  const data = JSON.parse(localStorage.getItem("yctScores")||"[]");
  const tbody = document.querySelector("#leaderboardTable tbody");
  tbody.innerHTML = data.map(r=>`<tr><td>${r.name}</td><td>${r.set}</td><td>${r.score}</td><td>${r.time}</td></tr>`).join("");
}

// ==== โหมดครู ====
function enterTeacherMode(){
  const pw = prompt("กรอกรหัสผ่านครู:");
  if(pw!=="2222") return alert("รหัสไม่ถูกต้อง");
  document.getElementById("startScreen").classList.add("hidden");
  document.getElementById("teacherScreen").classList.remove("hidden");
  renderTeacherTable();
}

function renderTeacherTable(){
  const data = JSON.parse(localStorage.getItem("yctScores")||"[]");
  const tbody = document.querySelector("#teacherTable tbody");
  tbody.innerHTML = data.map((r,i)=>
    `<tr>
      <td contenteditable onblur="updateRecord(${i},'name',this.innerText)">${r.name}</td>
      <td contenteditable onblur="updateRecord(${i},'set',this.innerText)">${r.set}</td>
      <td contenteditable onblur="updateRecord(${i},'score',this.innerText)">${r.score}</td>
      <td contenteditable onblur="updateRecord(${i},'time',this.innerText)">${r.time}</td>
      <td><button onclick="deleteRecord(${i})">ลบ</button></td>
    </tr>`).join("");
}

function updateRecord(i,key,val){
  const data = JSON.parse(localStorage.getItem("yctScores")||"[]");
  data[i][key] = val;
  localStorage.setItem("yctScores", JSON.stringify(data));
}

function deleteRecord(i){
  const data = JSON.parse(localStorage.getItem("yctScores")||"[]");
  if(confirm("ลบรายการนี้?")){data.splice(i,1); localStorage.setItem("yctScores",JSON.stringify(data)); renderTeacherTable();}
}

function addRecord(){
  const data = JSON.parse(localStorage.getItem("yctScores")||"[]");
  const now = new Date();
  const t = now.toLocaleTimeString('th-TH') + " " + now.toLocaleDateString('th-TH');
  data.push({name:"นักเรียนใหม่", set:"YCT1", score:0, time:t});
  localStorage.setItem("yctScores", JSON.stringify(data));
  renderTeacherTable();
}

function clearAll(){
  if(confirm("ลบทุกคะแนน?")){
    localStorage.removeItem("yctScores");
    renderTeacherTable();
  }
}
</script>
</body>
</html>
